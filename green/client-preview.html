<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Quote Preview - Stackr</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css">
  <!-- Stripe.js to ensure we're ready for payment processing -->
  <script src="https://js.stripe.com/v3/"></script>
  <style>
    /* Additional custom styles */
    .quote-header {
      background: linear-gradient(to right, #3b82f6, #2563eb);
    }
    .tier-card {
      transition: transform 0.3s, box-shadow 0.3s;
    }
    .tier-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
    }
    .fade-in {
      animation: fadeIn 0.5s ease-in;
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    /* Mobile-specific adjustments for Samsung ZFold4 */
    @media (max-width: 768px) {
      .quote-container {
        margin: 0;
        padding: 1rem;
      }
      .tier-section {
        flex-direction: column;
      }
      .tier-card {
        width: 100%;
        margin-bottom: 1rem;
      }
    }
  </style>
</head>
<body class="bg-gray-50 min-h-screen">
  <header class="quote-header text-white p-6">
    <div class="container mx-auto flex justify-between items-center">
      <div>
        <h1 class="text-2xl font-bold" id="business-name">Professional Services</h1>
        <p class="text-sm opacity-80" id="business-tagline">Quality service you can trust</p>
      </div>
      <div class="text-right">
        <p class="text-sm">Quote #<span id="quote-number">QT12345</span></p>
        <p class="text-sm" id="quote-date">April 28, 2025</p>
      </div>
    </div>
  </header>

  <div class="container mx-auto px-4 py-8">
    <div class="bg-white rounded-lg shadow-lg overflow-hidden">
      <!-- Quote Header Section -->
      <div class="p-6 border-b">
        <div class="flex flex-wrap justify-between">
          <div class="mb-4 md:mb-0">
            <h2 class="text-xl font-bold text-gray-800">Quote for <span id="customer-name">Client Name</span></h2>
            <p class="text-gray-600" id="quote-description">Bathroom remodeling with premium fixtures</p>
          </div>
          <div class="text-right">
            <div class="text-sm text-gray-600">Valid until:</div>
            <div class="font-medium" id="valid-until">May 28, 2025</div>
          </div>
        </div>
      </div>

      <!-- Quote Details Section -->
      <div class="p-6 bg-gray-50 border-b">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <h3 class="text-lg font-semibold mb-3">Service Details</h3>
            <div class="bg-white p-4 rounded border">
              <div class="mb-2">
                <span class="text-gray-600 text-sm">Service Type:</span>
                <span class="font-medium ml-2" id="service-type">Bathroom Remodel</span>
              </div>
              <div class="mb-2">
                <span class="text-gray-600 text-sm">Location:</span>
                <span class="font-medium ml-2" id="service-location">Denver, CO</span>
              </div>
              <div>
                <span class="text-gray-600 text-sm">Complexity:</span>
                <span class="font-medium ml-2" id="service-complexity">Medium</span>
              </div>
            </div>
          </div>
          <div>
            <h3 class="text-lg font-semibold mb-3">Service Provider</h3>
            <div class="bg-white p-4 rounded border">
              <div class="mb-2">
                <span class="text-gray-600 text-sm">Provider:</span>
                <span class="font-medium ml-2" id="provider-name">John Smith</span>
              </div>
              <div class="mb-2">
                <span class="text-gray-600 text-sm">Experience:</span>
                <span class="font-medium ml-2" id="provider-experience">5 years</span>
              </div>
              <div class="flex items-center">
                <span class="text-gray-600 text-sm">Rating:</span>
                <div class="ml-2 flex items-center">
                  <div class="flex text-yellow-400" id="provider-rating">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor">
                      <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor">
                      <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor">
                      <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor">
                      <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor">
                      <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                    </svg>
                  </div>
                  <span class="ml-1 text-sm text-gray-600">(4.8)</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Pricing Section -->
      <div class="p-6 border-b">
        <h3 class="text-lg font-semibold mb-3">Select Your Package</h3>
        
        <div class="tier-section flex flex-wrap gap-4 mt-6">
          <!-- Basic Tier -->
          <div class="tier-card flex-1 min-w-[250px] bg-white rounded-lg border border-gray-200 p-5 transition">
            <div class="mb-4">
              <h4 class="text-lg font-semibold">Basic</h4>
              <p class="text-sm text-gray-600 h-12">Essential service with standard materials and workmanship</p>
            </div>
            <div class="mb-4">
              <span class="text-3xl font-bold" id="basic-price">$7,492</span>
            </div>
            <div class="mb-4">
              <h5 class="font-medium text-sm mb-2">What's included:</h5>
              <ul class="text-sm text-gray-600 space-y-1" id="basic-features">
                <li class="flex items-start">
                  <svg class="h-5 w-5 text-green-500 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                  </svg>
                  <span>Standard fixtures</span>
                </li>
                <li class="flex items-start">
                  <svg class="h-5 w-5 text-green-500 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                  </svg>
                  <span>Basic materials</span>
                </li>
                <li class="flex items-start">
                  <svg class="h-5 w-5 text-green-500 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                  </svg>
                  <span>30-day warranty</span>
                </li>
              </ul>
            </div>
            <button class="w-full bg-gray-100 hover:bg-gray-200 text-gray-800 font-medium py-2 px-4 rounded transition select-tier" data-tier="basic">
              Select Package
            </button>
          </div>
          
          <!-- Standard Tier -->
          <div class="tier-card flex-1 min-w-[250px] bg-white rounded-lg border-2 border-blue-500 p-5 shadow-md relative transition">
            <div class="absolute top-0 right-0 bg-blue-500 text-white text-xs py-1 px-2 rounded-bl">RECOMMENDED</div>
            <div class="mb-4">
              <h4 class="text-lg font-semibold text-blue-700">Standard</h4>
              <p class="text-sm text-gray-600 h-12">Enhanced service with quality materials and detailed workmanship</p>
            </div>
            <div class="mb-4">
              <span class="text-3xl font-bold text-blue-700" id="standard-price">$7,867</span>
            </div>
            <div class="mb-4">
              <h5 class="font-medium text-sm mb-2">What's included:</h5>
              <ul class="text-sm text-gray-600 space-y-1" id="standard-features">
                <li class="flex items-start">
                  <svg class="h-5 w-5 text-green-500 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                  </svg>
                  <span>Premium fixtures</span>
                </li>
                <li class="flex items-start">
                  <svg class="h-5 w-5 text-green-500 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                  </svg>
                  <span>Quality materials</span>
                </li>
                <li class="flex items-start">
                  <svg class="h-5 w-5 text-green-500 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                  </svg>
                  <span>90-day warranty</span>
                </li>
                <li class="flex items-start">
                  <svg class="h-5 w-5 text-green-500 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                  </svg>
                  <span>Priority scheduling</span>
                </li>
              </ul>
            </div>
            <button class="w-full bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-4 rounded transition select-tier" data-tier="standard">
              Select Package
            </button>
          </div>
          
          <!-- Premium Tier -->
          <div class="tier-card flex-1 min-w-[250px] bg-white rounded-lg border border-gray-200 p-5 transition">
            <div class="mb-4">
              <h4 class="text-lg font-semibold">Premium</h4>
              <p class="text-sm text-gray-600 h-12">Luxury service with superior materials and craftsmanship</p>
            </div>
            <div class="mb-4">
              <span class="text-3xl font-bold" id="premium-price">$8,582</span>
            </div>
            <div class="mb-4">
              <h5 class="font-medium text-sm mb-2">What's included:</h5>
              <ul class="text-sm text-gray-600 space-y-1" id="premium-features">
                <li class="flex items-start">
                  <svg class="h-5 w-5 text-green-500 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                  </svg>
                  <span>Luxury fixtures</span>
                </li>
                <li class="flex items-start">
                  <svg class="h-5 w-5 text-green-500 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                  </svg>
                  <span>Premium materials</span>
                </li>
                <li class="flex items-start">
                  <svg class="h-5 w-5 text-green-500 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                  </svg>
                  <span>1-year warranty</span>
                </li>
                <li class="flex items-start">
                  <svg class="h-5 w-5 text-green-500 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                  </svg>
                  <span>Priority scheduling</span>
                </li>
                <li class="flex items-start">
                  <svg class="h-5 w-5 text-green-500 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                  </svg>
                  <span>Free follow-up inspection</span>
                </li>
              </ul>
            </div>
            <button class="w-full bg-gray-100 hover:bg-gray-200 text-gray-800 font-medium py-2 px-4 rounded transition select-tier" data-tier="premium">
              Select Package
            </button>
          </div>
        </div>
      </div>

      <!-- Quote Breakdown Section -->
      <div class="p-6 hidden" id="quote-breakdown-section">
        <h3 class="text-lg font-semibold mb-4">Quote Breakdown</h3>
        <table class="w-full text-sm">
          <thead>
            <tr class="border-b">
              <th class="text-left py-2 px-2">Item</th>
              <th class="text-right py-2 px-2">Cost</th>
            </tr>
          </thead>
          <tbody>
            <tr class="border-b">
              <td class="py-2 px-2">Labor</td>
              <td class="text-right py-2 px-2" id="breakdown-labor">$5,000.00</td>
            </tr>
            <tr class="border-b">
              <td class="py-2 px-2">Materials</td>
              <td class="text-right py-2 px-2" id="breakdown-materials">$2,500.00</td>
            </tr>
            <tr class="border-b bg-gray-50">
              <td class="py-2 px-2 font-medium">Total (before tax)</td>
              <td class="text-right py-2 px-2 font-medium" id="breakdown-subtotal">$7,500.00</td>
            </tr>
            <tr class="border-b">
              <td class="py-2 px-2">Estimated tax (5%)</td>
              <td class="text-right py-2 px-2" id="breakdown-tax">$375.00</td>
            </tr>
            <tr class="bg-blue-50">
              <td class="py-3 px-2 font-bold">Total</td>
              <td class="text-right py-3 px-2 font-bold" id="breakdown-total">$7,875.00</td>
            </tr>
          </tbody>
        </table>
        
        <div class="mt-6 p-4 bg-yellow-50 border-l-4 border-yellow-400 rounded" id="deposit-notice">
          <div class="flex">
            <div class="flex-shrink-0">
              <svg class="h-5 w-5 text-yellow-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
              </svg>
            </div>
            <div class="ml-3">
              <h3 class="text-sm font-medium text-yellow-800">Deposit Required</h3>
              <div class="mt-1 text-sm text-yellow-700">
                <p>A deposit of <span id="deposit-amount">$1,968.75</span> (25%) is required to secure your booking.</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Action Section -->
      <div class="p-6 bg-gray-50 flex flex-wrap justify-between items-center">
        <div class="mb-4 md:mb-0">
          <h3 class="text-lg font-semibold">Ready to move forward?</h3>
          <p class="text-sm text-gray-600">Select your preferred package and we'll get started.</p>
        </div>
        <div class="space-x-3">
          <a href="#" class="inline-block bg-white border border-gray-300 text-gray-700 px-4 py-2 rounded hover:bg-gray-50 transition">Request Changes</a>
          <button id="accept-quote" class="inline-block bg-green-500 text-white px-6 py-2 rounded hover:bg-green-600 transition" disabled>
            Accept & Proceed
          </button>
        </div>
      </div>
    </div>
    
    <!-- Selected Package Section -->
    <div id="selected-package" class="mt-6 p-6 bg-white border border-gray-200 rounded-lg hidden fade-in">
      <h3 class="text-lg font-semibold mb-3">Your Selected Package</h3>
      <div class="bg-blue-50 p-4 rounded-lg border border-blue-200">
        <div class="flex justify-between items-center mb-4">
          <div>
            <h4 class="font-semibold text-lg" id="selected-tier-name">Standard Package</h4>
            <p class="text-gray-600" id="selected-tier-description">Enhanced service with quality materials</p>
          </div>
          <div class="text-right">
            <span class="text-2xl font-bold text-blue-700" id="selected-tier-price">$7,867</span>
          </div>
        </div>
        <hr class="my-3 border-blue-200">
        <h5 class="font-medium mb-2">What's included:</h5>
        <ul class="text-sm text-gray-600 space-y-1 mb-4" id="selected-tier-features">
          <!-- Features will be inserted here -->
        </ul>
        <div class="mt-4">
          <p class="italic text-gray-500 text-sm">By accepting this quote, you agree to the terms and conditions outlined by the service provider.</p>
        </div>
      </div>
      
      <!-- Payment Options Section -->
      <div class="mt-6">
        <h4 class="text-lg font-semibold mb-3">Payment Options</h4>
        <div class="space-y-3">
          <div class="flex items-center">
            <input type="radio" id="payment-deposit" name="payment-option" value="deposit" class="mr-2" checked>
            <label for="payment-deposit" class="text-gray-800">
              Pay <span id="deposit-percent">50%</span> deposit now (<span id="deposit-value">$3,933.50</span>)
            </label>
          </div>
          <div class="flex items-center">
            <input type="radio" id="payment-full" name="payment-option" value="full" class="mr-2">
            <label for="payment-full" class="text-gray-800">
              Pay in full now
            </label>
          </div>
        </div>
      </div>
      
      <div class="flex justify-end mt-6">
        <button class="px-6 py-3 bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium rounded-md transition mr-3" id="change-package">
          Change Package
        </button>
        <button class="px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-md transition" id="accept-selected-quote">
          Accept Quote
        </button>
        <button class="px-6 py-3 bg-green-600 hover:bg-green-700 text-white font-medium flex items-center justify-center rounded-md transition ml-3" id="pay-now">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z" />
          </svg>
          Pay Now
        </button>
      </div>
    </div>
    
    <!-- Payment Processing Modal -->
    <div id="payment-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
      <div class="bg-white rounded-lg shadow-xl p-6 w-full max-w-md">
        <div class="flex justify-between items-center mb-4">
          <h3 class="text-xl font-bold">Payment</h3>
          <button id="close-payment-modal" class="text-gray-500 hover:text-gray-700">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>
        
        <div id="payment-processing" class="text-center py-6">
          <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-700 mx-auto mb-4"></div>
          <p class="text-gray-700">Processing your payment request...</p>
        </div>
        
        <div id="payment-error" class="hidden">
          <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4">
            <p id="error-message">An error occurred while processing your payment.</p>
          </div>
          <button id="try-again" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded transition">
            Try Again
          </button>
        </div>
        
        <div id="payment-element-container" class="hidden">
          <!-- Stripe Elements will be inserted here -->
          <div id="payment-element" class="mb-4"></div>
          <button id="submit-payment" class="w-full bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded transition">
            Complete Payment
          </button>
        </div>
        
        <div id="payment-success" class="hidden text-center py-6">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-green-500 mx-auto mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
          </svg>
          <h4 class="text-xl font-bold text-gray-800 mb-2">Payment Successful!</h4>
          <p class="text-gray-600 mb-4">Your payment has been processed successfully.</p>
          <button id="close-success" class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded transition">
            Close
          </button>
        </div>
      </div>
    </div>

    <!-- Success Message (initially hidden) -->
    <div id="success-message" class="mt-6 p-6 bg-green-50 border border-green-200 rounded-lg hidden fade-in">
      <div class="flex items-center">
        <div class="flex-shrink-0">
          <svg class="h-8 w-8 text-green-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
          </svg>
        </div>
        <div class="ml-4">
          <h3 class="text-lg font-medium text-green-800">Quote Accepted!</h3>
          <p class="mt-2 text-sm text-green-700">
            Your quote has been accepted. A confirmation email will be sent shortly with next steps.
          </p>
          <div class="mt-4">
            <button class="bg-green-100 text-green-800 px-4 py-2 rounded hover:bg-green-200 transition" id="view-details-btn">
              View Details
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script type="module">
    // Load quote data from URL parameter (in a real app, would get this from a database)
    // In this demo, we'll use hardcoded values from test data
    
    const quoteParams = new URLSearchParams(window.location.search);
    const quoteId = quoteParams.get('id') || 'demo';
    
    // Demo data for the bathroom remodel example
    const demoQuote = {
      id: "QT12345",
      businessName: "Stackr Remodeling",
      businessTagline: "Quality renovations you can trust",
      date: new Date().toLocaleDateString(),
      validUntil: new Date(Date.now() + 30*24*60*60*1000).toLocaleDateString(),
      customerName: "David Thompson",
      description: "Complete bathroom renovation with modern fixtures",
      serviceType: "Bathroom Remodel",
      serviceLocation: "Denver, CO",
      serviceComplexity: "Medium",
      providerName: "John Smith",
      providerExperience: "5 years",
      providerRating: 4.8,
      tiers: {
        basic: {
          price: 7492,
          features: [
            "Standard fixtures",
            "Basic materials",
            "30-day warranty",
            "Standard cleanup"
          ]
        },
        standard: {
          price: 7867,
          features: [
            "Premium fixtures",
            "Quality materials",
            "90-day warranty",
            "Priority scheduling",
            "Thorough cleanup"
          ]
        },
        premium: {
          price: 8582,
          features: [
            "Luxury fixtures",
            "Premium materials",
            "1-year warranty",
            "Priority scheduling",
            "Free follow-up inspection",
            "Detailed cleanup",
            "Designer consultation"
          ]
        }
      },
      breakdown: {
        labor: 5000,
        materials: 2500,
        taxRate: 0.05,
        depositPercent: 25
      }
    };
    
    // Initialize page with demo data
    function initPage() {
      // Set basic quote information
      document.getElementById('business-name').textContent = demoQuote.businessName;
      document.getElementById('business-tagline').textContent = demoQuote.businessTagline;
      document.getElementById('quote-number').textContent = demoQuote.id;
      document.getElementById('quote-date').textContent = demoQuote.date;
      document.getElementById('valid-until').textContent = demoQuote.validUntil;
      document.getElementById('customer-name').textContent = demoQuote.customerName;
      document.getElementById('quote-description').textContent = demoQuote.description;
      
      // Set service details
      document.getElementById('service-type').textContent = demoQuote.serviceType;
      document.getElementById('service-location').textContent = demoQuote.serviceLocation;
      document.getElementById('service-complexity').textContent = demoQuote.serviceComplexity;
      
      // Set provider details
      document.getElementById('provider-name').textContent = demoQuote.providerName;
      document.getElementById('provider-experience').textContent = demoQuote.providerExperience;
      
      // Set pricing options
      document.getElementById('basic-price').textContent = `$${demoQuote.tiers.basic.price.toLocaleString()}`;
      document.getElementById('standard-price').textContent = `$${demoQuote.tiers.standard.price.toLocaleString()}`;
      document.getElementById('premium-price').textContent = `$${demoQuote.tiers.premium.price.toLocaleString()}`;
      
      // Set features for each tier
      document.getElementById('basic-features').innerHTML = demoQuote.tiers.basic.features.map(feature => `
        <li class="flex items-start">
          <svg class="h-5 w-5 text-green-500 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
          </svg>
          <span>${feature}</span>
        </li>
      `).join('');
      
      document.getElementById('standard-features').innerHTML = demoQuote.tiers.standard.features.map(feature => `
        <li class="flex items-start">
          <svg class="h-5 w-5 text-green-500 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
          </svg>
          <span>${feature}</span>
        </li>
      `).join('');
      
      document.getElementById('premium-features').innerHTML = demoQuote.tiers.premium.features.map(feature => `
        <li class="flex items-start">
          <svg class="h-5 w-5 text-green-500 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
          </svg>
          <span>${feature}</span>
        </li>
      `).join('');
      
      // Initialize quote breakdown (hidden initially)
      updateBreakdown('standard'); // Default to standard tier
    }
    
    // Update quote breakdown based on selected tier
    function updateBreakdown(tier) {
      const price = demoQuote.tiers[tier].price;
      const labor = demoQuote.breakdown.labor;
      const materials = demoQuote.breakdown.materials;
      const subtotal = price;
      const tax = subtotal * demoQuote.breakdown.taxRate;
      const total = subtotal + tax;
      const deposit = total * (demoQuote.breakdown.depositPercent / 100);
      
      document.getElementById('breakdown-labor').textContent = `$${labor.toLocaleString()}`;
      document.getElementById('breakdown-materials').textContent = `$${materials.toLocaleString()}`;
      document.getElementById('breakdown-subtotal').textContent = `$${subtotal.toLocaleString()}`;
      document.getElementById('breakdown-tax').textContent = `$${tax.toLocaleString()}`;
      document.getElementById('breakdown-total').textContent = `$${total.toLocaleString()}`;
      document.getElementById('deposit-amount').textContent = `$${deposit.toLocaleString()} (${demoQuote.breakdown.depositPercent}%)`;
      
      // Show the breakdown section
      document.getElementById('quote-breakdown-section').classList.remove('hidden');
    }
    
    // Set up event listeners
    // Update the selected package display
    function updateSelectedPackage(tier) {
      const tierData = demoQuote.tiers[tier];
      
      // Update name, description and price
      document.getElementById('selected-tier-name').textContent = tier.charAt(0).toUpperCase() + tier.slice(1) + ' Package';
      document.getElementById('selected-tier-description').textContent = getTierDescription(tier);
      document.getElementById('selected-tier-price').textContent = `$${tierData.price.toLocaleString()}`;
      
      // Update features list
      document.getElementById('selected-tier-features').innerHTML = tierData.features.map(feature => `
        <li class="flex items-start">
          <svg class="h-5 w-5 text-green-500 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
          </svg>
          <span>${feature}</span>
        </li>
      `).join('');
      
      // Update deposit information
      updatePaymentAmount();
    }
    
    // Get a description for each tier
    function getTierDescription(tier) {
      const descriptions = {
        basic: 'Essential service with standard materials and workmanship',
        standard: 'Enhanced service with quality materials and detailed workmanship',
        premium: 'Premium service with luxury materials and expert craftsmanship'
      };
      return descriptions[tier];
    }
    
    // Update payment amount based on selected option
    function updatePaymentAmount() {
      const selectedTier = getCurrentSelectedTier();
      const price = demoQuote.tiers[selectedTier].price;
      const isFullPayment = document.getElementById('payment-full').checked;
      
      // Determine deposit percentage based on price
      let depositPercent = price > 2000 ? 25 : 50;
      
      // Update deposit percent display
      document.getElementById('deposit-percent').textContent = `${depositPercent}%`;
      
      // Calculate deposit amount
      const depositAmount = price * (depositPercent / 100);
      
      // Update deposit value display
      document.getElementById('deposit-value').textContent = `$${depositAmount.toLocaleString()}`;
    }
    
    // Get the currently selected tier
    function getCurrentSelectedTier() {
      const selectedButton = document.querySelector('.select-tier.bg-blue-500');
      return selectedButton ? selectedButton.dataset.tier : 'standard';
    }
    
    // Process payment with Stripe
    async function processPayment() {
      // Show payment modal
      document.getElementById('payment-modal').classList.remove('hidden');
      document.getElementById('payment-processing').classList.remove('hidden');
      document.getElementById('payment-error').classList.add('hidden');
      document.getElementById('payment-element-container').classList.add('hidden');
      document.getElementById('payment-success').classList.add('hidden');
      
      try {
        // Get payment details
        const selectedTier = getCurrentSelectedTier();
        const price = demoQuote.tiers[selectedTier].price;
        const isFullPayment = document.getElementById('payment-full').checked;
        const depositPercent = price > 2000 ? 25 : 50;
        const paymentAmount = isFullPayment ? price : price * (depositPercent / 100);
        
        // Create payment intent
        const response = await fetch('/api/create-payment-intent', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            amount: paymentAmount,
            invoiceId: demoQuote.id,
            customerName: demoQuote.customerName,
            description: `${demoQuote.description} - ${selectedTier} tier`,
            tier: selectedTier
          })
        });
        
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const data = await response.json();
        
        // If we're in development mode with a mock client secret
        if (data.isDevelopment) {
          console.log('Development mode detected, simulating payment...');
          
          // Hide processing, show success after a delay to simulate payment
          setTimeout(() => {
            document.getElementById('payment-processing').classList.add('hidden');
            document.getElementById('payment-success').classList.remove('hidden');
          }, 1500);
          
          return;
        }
        
        // Initialize Stripe
        const stripe = Stripe(data.stripePublicKey || 'pk_test_TYooMQauvdEDq54NiTphI7jx');
        
        // Show payment element
        document.getElementById('payment-processing').classList.add('hidden');
        document.getElementById('payment-element-container').classList.remove('hidden');
        
        // Set up Stripe Elements
        const elements = stripe.elements({
          clientSecret: data.clientSecret
        });
        
        // Create payment element
        const paymentElement = elements.create('payment');
        paymentElement.mount('#payment-element');
        
        // Handle payment submission
        document.getElementById('submit-payment').addEventListener('click', async function() {
          try {
            const { error } = await stripe.confirmPayment({
              elements,
              confirmParams: {
                return_url: window.location.origin + '/payment-success.html',
              },
              redirect: 'if_required'
            });
            
            if (error) {
              // Show error
              document.getElementById('error-message').textContent = error.message;
              document.getElementById('payment-element-container').classList.add('hidden');
              document.getElementById('payment-error').classList.remove('hidden');
            } else {
              // Show success
              document.getElementById('payment-element-container').classList.add('hidden');
              document.getElementById('payment-success').classList.remove('hidden');
            }
          } catch (error) {
            console.error('Payment confirmation error:', error);
            document.getElementById('error-message').textContent = 'An unexpected error occurred.';
            document.getElementById('payment-element-container').classList.add('hidden');
            document.getElementById('payment-error').classList.remove('hidden');
          }
        });
      } catch (error) {
        console.error('Payment processing error:', error);
        document.getElementById('error-message').textContent = error.message;
        document.getElementById('payment-processing').classList.add('hidden');
        document.getElementById('payment-error').classList.remove('hidden');
      }
    }
    
    function setupListeners() {
      // Set up tier selection
      const tierButtons = document.querySelectorAll('.select-tier');
      tierButtons.forEach(button => {
        button.addEventListener('click', function() {
          const tier = this.dataset.tier;
          
          // Reset all tier cards and buttons
          document.querySelectorAll('.tier-card').forEach(card => {
            card.classList.remove('border-2', 'border-blue-500', 'shadow-md');
            card.classList.add('border', 'border-gray-200');
          });
          
          document.querySelectorAll('.select-tier').forEach(btn => {
            btn.classList.remove('bg-blue-500', 'hover:bg-blue-600', 'text-white');
            btn.classList.add('bg-gray-100', 'hover:bg-gray-200', 'text-gray-800');
          });
          
          // Highlight selected tier
          const selectedCard = this.closest('.tier-card');
          selectedCard.classList.remove('border', 'border-gray-200');
          selectedCard.classList.add('border-2', 'border-blue-500', 'shadow-md');
          
          this.classList.remove('bg-gray-100', 'hover:bg-gray-200', 'text-gray-800');
          this.classList.add('bg-blue-500', 'hover:bg-blue-600', 'text-white');
          
          // Update breakdown
          updateBreakdown(tier);
          
          // Update selected package display
          updateSelectedPackage(tier);
          
          // Enable accept button
          document.getElementById('accept-quote').removeAttribute('disabled');
        });
      });
      
      // Set up accept button
      document.getElementById('accept-quote').addEventListener('click', function() {
        // Show selected package instead of success message
        document.getElementById('selected-package').classList.remove('hidden');
        
        // Hide the pricing tiers and breakdown sections
        document.querySelector('.tier-section').classList.add('hidden');
        document.getElementById('quote-breakdown-section').classList.add('hidden');
        
        // Hide the action section with the Accept button
        this.closest('.p-6').classList.add('hidden');
        
        // Scroll to selected package
        document.getElementById('selected-package').scrollIntoView({ behavior: 'smooth' });
      });
      
      // Set up payment option radio buttons
      document.getElementById('payment-deposit').addEventListener('change', updatePaymentAmount);
      document.getElementById('payment-full').addEventListener('change', updatePaymentAmount);
      
      // Set up change package button
      document.getElementById('change-package').addEventListener('click', function() {
        // Show the pricing tiers and breakdown sections
        document.querySelector('.tier-section').classList.remove('hidden');
        document.getElementById('quote-breakdown-section').classList.remove('hidden');
        
        // Show the action section with the Accept button
        document.querySelector('.p-6.bg-gray-50').classList.remove('hidden');
        
        // Hide selected package
        document.getElementById('selected-package').classList.add('hidden');
      });
      
      // Set up pay now button
      document.getElementById('pay-now').addEventListener('click', processPayment);
      
      // Set up close payment modal button
      document.getElementById('close-payment-modal').addEventListener('click', function() {
        document.getElementById('payment-modal').classList.add('hidden');
      });
      
      // Set up try again button
      document.getElementById('try-again').addEventListener('click', processPayment);
      
      // Set up close success button
      document.getElementById('close-success').addEventListener('click', function() {
        document.getElementById('payment-modal').classList.add('hidden');
        // Show success message for the quote
        document.getElementById('success-message').classList.remove('hidden');
        // Hide selected package
        document.getElementById('selected-package').classList.add('hidden');
        // Scroll to success message
        document.getElementById('success-message').scrollIntoView({ behavior: 'smooth' });
      });
      
      // Set up accept selected quote button
      document.getElementById('accept-selected-quote').addEventListener('click', function() {
        // Show success message
        document.getElementById('success-message').classList.remove('hidden');
        // Hide selected package
        document.getElementById('selected-package').classList.add('hidden');
        // Scroll to success message
        document.getElementById('success-message').scrollIntoView({ behavior: 'smooth' });
      });
      
      // Set up view details button
      document.getElementById('view-details-btn').addEventListener('click', function() {
        // In a real app, this would navigate to a details page
        alert('In a production app, this would navigate to the order details page.');
      });
    }
    
    // Initialize page
    document.addEventListener('DOMContentLoaded', function() {
      initPage();
      setupListeners();
    });
  </script>
</body>
</html>