<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=yes, viewport-fit=cover, target-densitydpi=device-dpi"
    />
    <title>Stackr - Personal Finance</title>
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
    />
    <style>
      /* Base styles */
      :root {
        --primary: #4f46e5;
        --primary-foreground: #ffffff;
        --background: #f8fafc;
        --foreground: #0f172a;
        --card: #ffffff;
        --card-foreground: #1e293b;
        --border: #e2e8f0;
        --input: #e2e8f0;
        --ring: #4f46e5;
        --radius: 0.5rem;
      }
      
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }
      
      body {
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
        background-color: var(--background);
        color: var(--foreground);
        line-height: 1.5;
      }
      
      #root {
        min-height: 100vh;
      }
      
      .error-container {
        padding: 2rem;
        max-width: 800px;
        margin: 0 auto;
        text-align: center;
      }
      
      .error-heading {
        color: #e11d48;
        font-size: 1.875rem;
        margin-bottom: 1rem;
      }
      
      .error-message {
        margin-bottom: 2rem;
      }
      
      .error-code {
        background: #f5f5f5;
        padding: 1rem;
        border-radius: 0.375rem;
        font-family: monospace;
        text-align: left;
        white-space: pre-wrap;
        overflow-wrap: break-word;
      }
    </style>
    
    <!-- Complete Firebase and Sanity Removal Script -->
    <script>
      console.log("Setting up complete Firebase and Sanity disabling system");
      
      // Permanent static configs with all required fields
      const FIREBASE_CONFIG = {
        apiKey: "mock-api-key",
        appId: "mock-app-id",
        authDomain: "mock-project-id.firebaseapp.com",
        databaseURL: "https://mock-project-id.firebaseio.com",
        measurementId: "G-MOCK000000",
        messagingSenderId: "000000000000",
        projectId: "mock-project-id",
        storageBucket: "mock-project-id.appspot.com"
      };
      
      // Set all global configuration variables explicitly
      window.__FIREBASE_CONFIG__ = FIREBASE_CONFIG;
      window.__FIREBASE_DEFAULTS__ = { config: FIREBASE_CONFIG };
      
      // Mock Sanity config
      window.__SANITY_CLIENT__ = {
        projectId: 'mock-project-id',
        dataset: 'production',
        apiVersion: '2023-04-01',
        useCdn: true
      };
      
      // Create a permanently defined Firebase global that cannot be overridden
      const firebaseMock = {
        // Top level methods
        initializeApp: function() {
          console.log("Firebase mock: initializeApp called");
          return {
            options: FIREBASE_CONFIG,
            auth: function() {
              return {
                onAuthStateChanged: function(observer) { 
                  setTimeout(function() { observer(null); }, 0); 
                  return function() {}; 
                },
                signOut: function() { return Promise.resolve(); },
                setPersistence: function() { return Promise.resolve(); },
                signInWithEmailAndPassword: function() { 
                  return Promise.resolve({ user: null }); 
                },
                createUserWithEmailAndPassword: function() { 
                  return Promise.resolve({ user: null }); 
                },
                sendPasswordResetEmail: function() { return Promise.resolve(); },
                currentUser: null
              };
            },
            firestore: function() {
              return {
                collection: function() {
                  return {
                    doc: function() {
                      return {
                        get: function() { 
                          return Promise.resolve({ 
                            exists: false, 
                            data: function() { return null; } 
                          }); 
                        },
                        set: function() { return Promise.resolve(); },
                        update: function() { return Promise.resolve(); }
                      };
                    }
                  };
                }
              };
            }
          };
        },
        
        // Auth related methods
        auth: {
          GoogleAuthProvider: {
            PROVIDER_ID: 'google.com',
            credentialFromResult: function() { return null; },
            credentialFromError: function() { return null; }
          }
        }
      };
      
      // Set firebase global
      Object.defineProperty(window, 'firebase', {
        value: firebaseMock,
        writable: false,
        configurable: false
      });
      
      // Block any AMD/UMD loading attempts for Firebase or Sanity
      window.define = window.define || function(name, deps, callback) {
        if (typeof name === 'string' && 
            (name.includes('firebase') || name.includes('sanity'))) {
          console.log("Blocked attempt to load: " + name);
          return null;
        }
        
        if (typeof callback === 'function') {
          try { callback(); } catch(e) {}
        }
      };
      
      console.log("Firebase and Sanity completely disabled");
    </script>
  </head>
  <body>
    <div id="root">
      <!-- Fallback content if JavaScript fails to load -->
      <div class="error-container">
        <h2 class="error-heading">Loading Stackr...</h2>
        <p class="error-message">Please wait while we set up your financial dashboard.</p>
      </div>
    </div>
    
    <!-- Use direct-main.tsx for clean app with no Firebase -->
    <script type="module" src="/src/direct-main.tsx"></script>
    
    <!-- Replit badge -->
    <script
      type="text/javascript"
      src="https://replit.com/public/js/replit-badge-v3.js"
    ></script>
  </body>
</html>
